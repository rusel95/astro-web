# Spec #65: Composite Chart –¥–ª—è –ø–∞—Ä

## –ú–µ—Ç–∞
–°—Ç–≤–æ—Ä–∏—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª Composite Chart ‚Äî –æ–∫—Ä–µ–º—É –∞—Å—Ç—Ä–æ–ª–æ–≥—ñ—á–Ω—É –∫–∞—Ä—Ç—É –≤—ñ–¥–Ω–æ—Å–∏–Ω –º—ñ–∂ –¥–≤–æ–º–∞ –ª—é–¥—å–º–∏, —è–∫–∞ –ø–æ–∫–∞–∑—É—î –ø—Ä–∏—Ä–æ–¥—É —Å—Ç–æ—Å—É–Ω–∫—ñ–≤ —è–∫ –æ–∫—Ä–µ–º–æ—ó —Å—É—Ç–Ω–æ—Å—Ç—ñ.

## –ß–æ–º—É —Ü–µ –≤–∞–∂–ª–∏–≤–æ
- **Relationship insights:** –¶–µ –Ω–µ –ø—Ä–æ—Å—Ç–æ compatibility (—Å—É–º—ñ—Å–Ω—ñ—Å—Ç—å), –∞ –≥–ª–∏–±–æ–∫–∏–π –∞–Ω–∞–ª—ñ–∑ –ü–†–ò–†–û–î–ò –≤—ñ–¥–Ω–æ—Å–∏–Ω
- **Premium feature:** CafeAstrology —Ç–∞ Astro.com –º–∞—é—Ç—å —Ü–µ —è–∫ —Ç–æ–ø-feature, –ª—é–¥–∏ –≥–æ—Ç–æ–≤—ñ –ø–ª–∞—Ç–∏—Ç–∏
- **Emotional engagement:** –°—Ç–æ—Å—É–Ω–∫–∏ ‚Äî –Ω–∞–π—Å–∏–ª—å–Ω—ñ—à–∞ –º–æ—Ç–∏–≤–∞—Ü—ñ—è –¥–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
- **Differentiation:** –ë—ñ–ª—å—à—ñ—Å—Ç—å –ø—Ä–æ—Å—Ç–∏—Ö –∞—Å—Ç—Ä–æ-–∞–ø—ñ–≤ –Ω–µ –º–∞—é—Ç—å —Ü—å–æ–≥–æ (–∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–∞ –ø–µ—Ä–µ–≤–∞–≥–∞)

## –©–æ —Ç–∞–∫–µ Composite Chart?

**–ö–æ–Ω—Ü–µ–ø—Ü—ñ—è:**
Composite Chart —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è —à–ª—è—Ö–æ–º —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É —Å–µ—Ä–µ–¥–Ω—å–æ—ó —Ç–æ—á–∫–∏ (midpoint) –º—ñ–∂ –∫–æ–∂–Ω–æ—é –ø–ª–∞–Ω–µ—Ç–æ—é –¥–≤–æ—Ö –Ω–∞—Ç–∞–ª—å–Ω–∏—Ö –∫–∞—Ä—Ç. –¶–µ —Å—Ç–≤–æ—Ä—é—î –Ω–æ–≤—É –∫–∞—Ä—Ç—É, —è–∫–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—î —Å–∞–º—É –°–£–¢–ù–Ü–°–¢–¨ –≤—ñ–¥–Ω–æ—Å–∏–Ω, –∞ –Ω–µ –æ–∫—Ä–µ–º–∏—Ö –ø–∞—Ä—Ç–Ω–µ—Ä—ñ–≤.

**–ü—Ä–∏–∫–ª–∞–¥:**
- –ü–∞—Ä—Ç–Ω–µ—Ä –ê: –°–æ–Ω—Ü–µ –≤ 10¬∞ –û–≤–Ω–∞
- –ü–∞—Ä—Ç–Ω–µ—Ä –ë: –°–æ–Ω—Ü–µ –≤ 20¬∞ –ë–ª–∏–∑–Ω—é–∫—ñ–≤
- Composite –°–æ–Ω—Ü–µ: —Å–µ—Ä–µ–¥–∏–Ω–∞ –º—ñ–∂ –Ω–∏–º–∏ = ~0¬∞ –ë–ª–∏–∑–Ω—é–∫—ñ–≤

–¶—è –Ω–æ–≤–∞ –∫–∞—Ä—Ç–∞ —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç—É—î—Ç—å—Å—è —è–∫ "–æ—Å–æ–±–∏—Å—Ç—ñ—Å—Ç—å" —Å—Ç–æ—Å—É–Ω–∫—ñ–≤.

## –§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ –≤–∏–º–æ–≥–∏

### 1. –í—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ
–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–≤–æ–¥–∏—Ç—å –¥–∞–Ω—ñ –¥–ª—è –¥–≤–æ—Ö –ª—é–¥–µ–π:
- **–û—Å–æ–±–∞ 1:** –Ü–º'—è, –¥–∞—Ç–∞ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è, —á–∞—Å, –º—ñ—Å—Ü–µ (–≤–∂–µ —î –≤ —Å–∏—Å—Ç–µ–º—ñ)
- **–û—Å–æ–±–∞ 2:** –Ü–º'—è, –¥–∞—Ç–∞ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è, —á–∞—Å, –º—ñ—Å—Ü–µ (–≤–≤–æ–¥–∏—Ç—å –Ω–æ–≤–∏–π)

### 2. –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ Composite Chart

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
```typescript
interface CompositePlanet {
  name: string;
  longitude: number;  // –ï–∫–ª–∏–ø—Ç–∏—á–Ω–∞ –¥–æ–≤–≥–æ—Ç–∞ (0-360¬∞)
  sign: string;       // –ó–Ω–∞–∫ –∑–æ–¥—ñ–∞–∫—É
  house: number;      // –î—ñ–º (1-12)
}

function calculateComposite(
  chart1: NatalChart,
  chart2: NatalChart
): CompositeChart {
  const compositePlanets: CompositePlanet[] = [];
  
  for (const planet of PLANETS) {
    const lon1 = chart1.planets[planet].longitude;
    const lon2 = chart2.planets[planet].longitude;
    
    // –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ —Å–µ—Ä–µ–¥–Ω—å–æ—ó —Ç–æ—á–∫–∏
    const compositeLon = calculateMidpoint(lon1, lon2);
    
    compositePlanets.push({
      name: planet,
      longitude: compositeLon,
      sign: getSign(compositeLon),
      house: getHouse(compositeLon, compositeAscendant)
    });
  }
  
  return { planets: compositePlanets, aspects: calculateAspects(compositePlanets) };
}

function calculateMidpoint(lon1: number, lon2: number): number {
  // –í–∞–∂–ª–∏–≤–æ: –≤—Ä–∞—Ö–æ–≤—É–≤–∞—Ç–∏ –Ω–∞–π–∫–æ—Ä–æ—Ç—à–∏–π —à–ª—è—Ö –ø–æ –∫–æ–ª—É (0-360¬∞)
  const diff = Math.abs(lon2 - lon1);
  
  if (diff <= 180) {
    // –ü—Ä—è–º–∞ —Å–µ—Ä–µ–¥–Ω—è —Ç–æ—á–∫–∞
    return (lon1 + lon2) / 2;
  } else {
    // –ó–≤–æ—Ä–æ—Ç–Ω–∞ —Å–µ—Ä–µ–¥–Ω—è —Ç–æ—á–∫–∞ (—á–µ—Ä–µ–∑ 0¬∞)
    let midpoint = ((lon1 + lon2) / 2 + 180) % 360;
    return midpoint;
  }
}
```

**–ü–ª–∞–Ω–µ—Ç–∏ –¥–ª—è —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É:**
- –°–æ–Ω—Ü–µ, –ú—ñ—Å—è—Ü—å, –ú–µ—Ä–∫—É—Ä—ñ–π, –í–µ–Ω–µ—Ä–∞, –ú–∞—Ä—Å, –Æ–ø—ñ—Ç–µ—Ä, –°–∞—Ç—É—Ä–Ω
- –û–ø—Ü—ñ–π–Ω–æ: –£—Ä–∞–Ω, –ù–µ–ø—Ç—É–Ω, –ü–ª—É—Ç–æ–Ω (–ø–æ–≤—ñ–ª—å–Ω—ñ –ø–ª–∞–Ω–µ—Ç–∏, –º–µ–Ω—à –∑–Ω–∞—á—É—â—ñ –¥–ª—è –≤—ñ–¥–Ω–æ—Å–∏–Ω)
- Ascendant (–≤–∏—Å—Ö—ñ–¥–Ω–∏–π –∑–Ω–∞–∫) —Ç–∞ MC (–°–µ—Ä–µ–¥–∏–Ω–∞ –ù–µ–±–∞)

### 3. –Ü–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü—ñ—è

**–§–æ–∫—É—Å –Ω–∞ –∫–ª—é—á–æ–≤–∏—Ö –µ–ª–µ–º–µ–Ω—Ç–∞—Ö:**

1. **Composite –°–æ–Ω—Ü–µ (Core of the relationship)**
   - –û—Å–Ω–æ–≤–Ω–∞ —ñ–¥–µ–Ω—Ç–∏—á–Ω—ñ—Å—Ç—å –≤—ñ–¥–Ω–æ—Å–∏–Ω
   - –¶—ñ–ª—å —Ç–∞ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è —Å—Ç–æ—Å—É–Ω–∫—ñ–≤
   - "–•—Ç–æ –º–∏ —è–∫ –ø–∞—Ä–∞?"

2. **Composite –ú—ñ—Å—è—Ü—å (Emotional bond)**
   - –ï–º–æ—Ü—ñ–π–Ω–∞ –æ—Å–Ω–æ–≤–∞ –≤—ñ–¥–Ω–æ—Å–∏–Ω
   - –Ø–∫ –ø–∞—Ä–∞ –ø–æ—á—É–≤–∞—î—Ç—å—Å—è —Ä–∞–∑–æ–º
   - –Ü–Ω—Ç–∏–º–Ω—ñ—Å—Ç—å —Ç–∞ –∫–æ–º—Ñ–æ—Ä—Ç

3. **Composite –í–µ–Ω–µ—Ä–∞ (Love & harmony)**
   - –©–æ –ø—Ä–∏–Ω–æ—Å–∏—Ç—å —Ä–∞–¥—ñ—Å—Ç—å —É –≤—ñ–¥–Ω–æ—Å–∏–Ω–∞—Ö
   - –°–ø—ñ–ª—å–Ω—ñ —Ü—ñ–Ω–Ω–æ—Å—Ç—ñ
   - –†–æ–º–∞–Ω—Ç–∏—á–Ω–∞ –∞—Ç–º–æ—Å—Ñ–µ—Ä–∞

4. **Composite –ú–∞—Ä—Å (Energy & conflict)**
   - –Ø–∫ –ø–∞—Ä–∞ –¥—ñ—î —Ä–∞–∑–æ–º
   - –°–µ–∫—Å—É–∞–ª—å–Ω–∞ –µ–Ω–µ—Ä–≥—ñ—è
   - –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∫–æ–Ω—Ñ–ª—ñ–∫—Ç–∞–º–∏

5. **Composite –ú–µ—Ä–∫—É—Ä—ñ–π (Communication)**
   - –Ø–∫ –ø–∞—Ä–∞ —Å–ø—ñ–ª–∫—É—î—Ç—å—Å—è
   - –Ü–Ω—Ç–µ–ª–µ–∫—Ç—É–∞–ª—å–Ω–∏–π –∑–≤'—è–∑–æ–∫
   - –ü—Ä–∏–π–Ω—è—Ç—Ç—è —Ä—ñ—à–µ–Ω—å

6. **Composite Ascendant (How others see the relationship)**
   - –ó–æ–≤–Ω—ñ—à–Ω—î –≤—Ä–∞–∂–µ–Ω–Ω—è –≤—ñ–¥ –ø–∞—Ä–∏
   - –°–ø—ñ–ª—å–Ω–∞ –º–∞—Å–∫–∞/—Ä–æ–ª—å

7. **Composite 7th House (Partnership dynamics)**
   - –î–∏–Ω–∞–º—ñ–∫–∞ –ø–∞—Ä—Ç–Ω–µ—Ä—Å—Ç–≤–∞
   - –ë–∞–ª–∞–Ω—Å —Ç–∞ –≤–∑–∞—î–º–æ–¥—ñ—è

**AI Prompts –¥–ª—è —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü—ñ—ó:**
```typescript
const prompt = `
–¢–∏ –ø—Ä–æ—Ñ–µ—Å—ñ–π–Ω–∏–π –∞—Å—Ç—Ä–æ–ª–æ–≥. –ü—Ä–æ–∞–Ω–∞–ª—ñ–∑—É–π Composite Chart –¥–ª—è –ø–∞—Ä–∏.

Composite Sun: ${sun.sign} —É ${sun.house} –¥–æ–º—ñ
Composite Moon: ${moon.sign} —É ${moon.house} –¥–æ–º—ñ
Composite Venus: ${venus.sign} —É ${venus.house} –¥–æ–º—ñ
Composite Mars: ${mars.sign} —É ${mars.house} –¥–æ–º—ñ
Composite Mercury: ${mercury.sign} —É ${mercury.house} –¥–æ–º—ñ

–ê—Å–ø–µ–∫—Ç–∏:
${aspects.join('\n')}

–ù–∞–ø–∏—à–∏ –¥–µ—Ç–∞–ª—å–Ω–∏–π –∞–Ω–∞–ª—ñ–∑ (—É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—é, 500-700 —Å–ª—ñ–≤):

1. –û–°–ù–û–í–ê –í–Ü–î–ù–û–°–ò–ù (Composite Sun)
   - –Ø–∫–∞ –≥–æ–ª–æ–≤–Ω–∞ —Ü—ñ–ª—å —Ç–∞ —ñ–¥–µ–Ω—Ç–∏—á–Ω—ñ—Å—Ç—å —Ü–∏—Ö –≤—ñ–¥–Ω–æ—Å–∏–Ω?
   
2. –ï–ú–û–¶–Ü–ô–ù–ò–ô –ó–í'–Ø–ó–û–ö (Composite Moon)
   - –Ø–∫ –ø–∞—Ä–∞ –ø–æ—á—É–≤–∞—î—Ç—å—Å—è —Ä–∞–∑–æ–º? –ï–º–æ—Ü—ñ–π–Ω–∞ –±–µ–∑–ø–µ–∫–∞?
   
3. –õ–Æ–ë–û–í –¢–ê –ì–ê–†–ú–û–ù–Ü–Ø (Composite Venus)
   - –©–æ –ø—Ä–∏–Ω–æ—Å–∏—Ç—å —Ä–∞–¥—ñ—Å—Ç—å? –°–ø—ñ–ª—å–Ω—ñ —Ü—ñ–Ω–Ω–æ—Å—Ç—ñ?
   
4. –ï–ù–ï–†–ì–Ü–Ø –¢–ê –ö–û–ù–§–õ–Ü–ö–¢–ò (Composite Mars)
   - –Ø–∫ –ø–∞—Ä–∞ –¥—ñ—î —Ä–∞–∑–æ–º? –Ø–∫ –≤–∏—Ä—ñ—à—É—é—Ç—å—Å—è –∫–æ–Ω—Ñ–ª—ñ–∫—Ç–∏?
   
5. –ö–û–ú–£–ù–Ü–ö–ê–¶–Ü–Ø (Composite Mercury)
   - –Ø–∫ –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è —Å–ø—ñ–ª–∫—É–≤–∞–Ω–Ω—è? –í–∑–∞—î–º–æ—Ä–æ–∑—É–º—ñ–Ω–Ω—è?

6. –í–ò–ö–õ–ò–ö–ò –¢–ê –ü–û–†–ê–î–ò
   - –ù–∞ —â–æ –∑–≤–µ—Ä–Ω—É—Ç–∏ —É–≤–∞–≥—É?
   - –Ø–∫ –∑–º—ñ—Ü–Ω–∏—Ç–∏ –≤—ñ–¥–Ω–æ—Å–∏–Ω–∏?

–¢–æ–Ω: –ø—ñ–¥—Ç—Ä–∏–º—É—é—á–∏–π, realistic (–Ω–µ —Ç—ñ–ª—å–∫–∏ –ø–æ–∑–∏—Ç–∏–≤), –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω–∏–π.
`;
```

### 4. UI/UX Flow

**–ö—Ä–æ–∫ 1: –í–∏–±—ñ—Ä –ø–∞—Ä—Ç–Ω–µ—Ä–∞**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  –°—Ç–≤–æ—Ä–∏—Ç–∏ Composite Chart               ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  –í–∞—à–∞ –Ω–∞—Ç–∞–ª—å–Ω–∞ –∫–∞—Ä—Ç–∞: [–í–∂–µ –∑–±–µ—Ä–µ–∂–µ–Ω–∞]   ‚îÇ
‚îÇ  –û–ª–µ–∫—Å–∞–Ω–¥—Ä, 15 –±–µ—Ä–µ–∑–Ω—è 1990, 14:30      ‚îÇ
‚îÇ                                          ‚îÇ
‚îÇ  –ü–∞—Ä—Ç–Ω–µ—Ä/–¥—Ä—É–≥:                           ‚îÇ
‚îÇ  –Ü–º'—è: [_________]                       ‚îÇ
‚îÇ  –î–∞—Ç–∞: [__/__/____]                      ‚îÇ
‚îÇ  –ß–∞—Å: [__:__]                            ‚îÇ
‚îÇ  –ú—ñ—Å—Ü–µ: [–ê–≤—Ç–æ–∫–æ–º–ø–ª—ñ—Ç –º—ñ—Å—Ç]               ‚îÇ
‚îÇ                                          ‚îÇ
‚îÇ  [–†–æ–∑—Ä–∞—Ö—É–≤–∞—Ç–∏ Composite Chart ‚Üí]         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–ö—Ä–æ–∫ 2: –†–µ–∑—É–ª—å—Ç–∞—Ç**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Composite Chart: –û–ª–µ–∫—Å–∞–Ω–¥—Ä + –ú–∞—Ä—ñ—è     ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  [–í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è Composite Chart]          ‚îÇ
‚îÇ  (–∫—ñ–ª—å—Ü–µ –∑–æ–¥—ñ–∞–∫—É + –ø–ª–∞–Ω–µ—Ç–∏)             ‚îÇ
‚îÇ                                          ‚îÇ
‚îÇ  ‚ïê‚ïê‚ïê –ê–ù–ê–õ–Ü–ó –í–Ü–î–ù–û–°–ò–ù ‚ïê‚ïê‚ïê                ‚îÇ
‚îÇ                                          ‚îÇ
‚îÇ  üåû –û—Å–Ω–æ–≤–∞ –≤—ñ–¥–Ω–æ—Å–∏–Ω                      ‚îÇ
‚îÇ  –°–æ–Ω—Ü–µ –≤ –ë–ª–∏–∑–Ω—é–∫–∞—Ö —É 7 –¥–æ–º—ñ              ‚îÇ
‚îÇ  [AI —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü—ñ—è 2-3 –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∏]        ‚îÇ
‚îÇ                                          ‚îÇ
‚îÇ  üåô –ï–º–æ—Ü—ñ–π–Ω–∏–π –∑–≤'—è–∑–æ–∫                    ‚îÇ
‚îÇ  –ú—ñ—Å—è—Ü—å —É –†–∞–∫—É —É 8 –¥–æ–º—ñ                  ‚îÇ
‚îÇ  [AI —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü—ñ—è]                      ‚îÇ
‚îÇ                                          ‚îÇ
‚îÇ  [... —ñ–Ω—à—ñ –ø–ª–∞–Ω–µ—Ç–∏ ...]                  ‚îÇ
‚îÇ                                          ‚îÇ
‚îÇ  ‚ö†Ô∏è –í–∏–∫–ª–∏–∫–∏ —Ç–∞ –ø–æ—Ä–∞–¥–∏                    ‚îÇ
‚îÇ  [AI recommendations]                    ‚îÇ
‚îÇ                                          ‚îÇ
‚îÇ  [–ü–æ–¥—ñ–ª–∏—Ç–∏—Å—å] [–ó–±–µ—Ä–µ–≥—Ç–∏ PDF]             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–ö—Ä–æ–∫ 3: Share Card (–¥–ª—è —Å–æ—Ü–º–µ—Ä–µ–∂)**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  –û–ª–µ–∫—Å–∞–Ω–¥—Ä + –ú–∞—Ä—ñ—è                  ‚îÇ
‚îÇ  Composite Chart                     ‚îÇ
‚îÇ                                      ‚îÇ
‚îÇ  üåû –°–æ–Ω—Ü–µ –≤ –ë–ª–∏–∑–Ω—é–∫–∞—Ö (7 –¥—ñ–º)       ‚îÇ
‚îÇ  üåô –ú—ñ—Å—è—Ü—å —É –†–∞–∫—É (8 –¥—ñ–º)           ‚îÇ
‚îÇ  üíï –í–µ–Ω–µ—Ä–∞ –≤ –¢—ñ–ª—å—Ü—ñ (5 –¥—ñ–º)         ‚îÇ
‚îÇ                                      ‚îÇ
‚îÇ  "–í—ñ–¥–Ω–æ—Å–∏–Ω–∏, –ø–æ–±—É–¥–æ–≤–∞–Ω—ñ –Ω–∞           ‚îÇ
‚îÇ   –≥–ª–∏–±–æ–∫–æ–º—É –µ–º–æ—Ü—ñ–π–Ω–æ–º—É –∑–≤'—è–∑–∫—É       ‚îÇ
‚îÇ   —Ç–∞ —ñ–Ω—Ç–µ–ª–µ–∫—Ç—É–∞–ª—å–Ω—ñ–π —Å—É–º—ñ—Å–Ω–æ—Å—Ç—ñ"    ‚îÇ
‚îÇ                                      ‚îÇ
‚îÇ  AstroSvitla.com                     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## –¢–µ—Ö–Ω—ñ—á–Ω–∞ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è

### 1. –§–∞–π–ª–æ–≤–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
```
app/dashboard/composite/
  page.tsx                          // –ì–æ–ª–æ–≤–Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞
  [id]/
    page.tsx                        // –†–µ–∑—É–ª—å—Ç–∞—Ç Composite Chart
  components/
    CompositeForm.tsx               // –§–æ—Ä–º–∞ –≤–≤–æ–¥—É –ø–∞—Ä—Ç–Ω–µ—Ä–∞
    CompositeChart.tsx              // –í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è
    CompositeAnalysis.tsx           // AI –∞–Ω–∞–ª—ñ–∑
    
lib/astro/
  compositeCalculations.ts          // –õ–æ–≥—ñ–∫–∞ —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É
  
api/composite/
  calculate/route.ts                // API endpoint
```

### 2. –ë–∞–∑–∞ –¥–∞–Ω–∏—Ö

**–ù–æ–≤–∞ —Ç–∞–±–ª–∏—Ü—è:**
```sql
CREATE TABLE composite_charts (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  user_id UUID REFERENCES auth.users(id),
  person1_name VARCHAR(255),
  person1_chart_id UUID REFERENCES natal_charts(id),
  person2_name VARCHAR(255),
  person2_birth_date TIMESTAMP,
  person2_birth_time TIME,
  person2_birth_place VARCHAR(255),
  person2_lat DECIMAL(10, 6),
  person2_lon DECIMAL(10, 6),
  composite_data JSONB NOT NULL,  -- Composite –ø–ª–∞–Ω–µ—Ç–∏ + –∞—Å–ø–µ–∫—Ç–∏
  analysis TEXT,                   -- AI-generated analysis
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);

CREATE INDEX idx_composite_user ON composite_charts(user_id);
```

**composite_data JSONB —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```json
{
  "planets": {
    "sun": { "longitude": 75.5, "sign": "Gemini", "house": 7 },
    "moon": { "longitude": 120.3, "sign": "Cancer", "house": 8 },
    "venus": { "longitude": 45.2, "sign": "Taurus", "house": 5 },
    ...
  },
  "aspects": [
    { "planet1": "sun", "planet2": "venus", "type": "trine", "orb": 2.1 },
    ...
  ],
  "houses": {
    "1": 0,
    "2": 30,
    ...
  }
}
```

### 3. API Endpoint

**Route:** `POST /api/composite/calculate`

**Request:**
```json
{
  "person1ChartId": "uuid-of-user-chart",
  "person2": {
    "name": "–ú–∞—Ä—ñ—è",
    "birthDate": "1992-07-20",
    "birthTime": "09:30",
    "birthPlace": "–ö–∏—ó–≤, –£–∫—Ä–∞—ó–Ω–∞",
    "lat": 50.4501,
    "lon": 30.5234
  }
}
```

**Response:**
```json
{
  "compositeId": "uuid",
  "compositeChart": {
    "planets": {...},
    "aspects": [...],
    "houses": {...}
  },
  "analysis": "AI-generated text..."
}
```

**–û–±—Ä–æ–±–∫–∞:**
1. –û—Ç—Ä–∏–º–∞—Ç–∏ person1 natal chart –∑ DB
2. –†–æ–∑—Ä–∞—Ö—É–≤–∞—Ç–∏ person2 natal chart (Swiss Ephemeris)
3. –û–±—á–∏—Å–ª–∏—Ç–∏ Composite Chart (midpoints)
4. –†–æ–∑—Ä–∞—Ö—É–≤–∞—Ç–∏ –∞—Å–ø–µ–∫—Ç–∏ –≤ Composite Chart
5. –ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ AI –∞–Ω–∞–ª—ñ–∑
6. –ó–±–µ—Ä–µ–≥—Ç–∏ –≤ DB
7. –ü–æ–≤–µ—Ä–Ω—É—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç

### 4. –í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è Composite Chart

**–û–ø—Ü—ñ—ó:**
1. **Canvas-based:** –ú–∞–ª—é–≤–∞—Ç–∏ –≤–ª–∞—Å–Ω–æ—Ä—É—á (–ø–æ–≤–Ω–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å)
2. **SVG-based:** –í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –±—ñ–±–ª—ñ–æ—Ç–µ–∫—É (–ø—Ä–æ—Å—Ç—ñ—à–µ)
3. **–°–ø—Ä–æ—â–µ–Ω–∞ –≤–µ—Ä—Å—ñ—è:** –¢—ñ–ª—å–∫–∏ —Å–ø–∏—Å–æ–∫ –ø–ª–∞–Ω–µ—Ç –±–µ–∑ –≥—Ä–∞—Ñ—ñ–∫–∏ (MVP)

**MVP —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è:** –°–ø—Ä–æ—â–µ–Ω–∞ –≤–µ—Ä—Å—ñ—è (—Ç–∞–±–ª–∏—Ü—è + —Ç–µ–∫—Å—Ç), –≥—Ä–∞—Ñ—ñ–∫—É –¥–æ–¥–∞—Ç–∏ –ø—ñ–∑–Ω—ñ—à–µ.

```tsx
<div className="composite-planets">
  <h3>–ü–ª–∞–Ω–µ—Ç–∏ –≤ Composite Chart</h3>
  <table>
    <thead>
      <tr>
        <th>–ü–ª–∞–Ω–µ—Ç–∞</th>
        <th>–ó–Ω–∞–∫</th>
        <th>–î—ñ–º</th>
        <th>–ó–Ω–∞—á–µ–Ω–Ω—è</th>
      </tr>
    </thead>
    <tbody>
      {planets.map(planet => (
        <tr key={planet.name}>
          <td>{planet.emoji} {planet.name}</td>
          <td>{planet.sign}</td>
          <td>{planet.house}</td>
          <td>{planet.interpretation}</td>
        </tr>
      ))}
    </tbody>
  </table>
</div>
```

## –ú–æ–Ω–µ—Ç–∏–∑–∞—Ü—ñ—è

**–í–∞—Ä—ñ–∞–Ω—Ç 1: Premium Feature**
- Free users: 1 Composite Chart –Ω–∞ –º—ñ—Å—è—Ü—å
- Premium users: –ù–µ–æ–±–º–µ–∂–µ–Ω–æ

**–í–∞—Ä—ñ–∞–Ω—Ç 2: Pay-per-report**
- ‚Ç¥49 –∑–∞ –æ–¥–∏–Ω Composite Chart
- –ê–±–æ Premium –ø—ñ–¥–ø–∏—Å–∫–∞ –≤–∫–ª—é—á–∞—î

**–í–∞—Ä—ñ–∞–Ω—Ç 3 (MVP): –ë–µ–∑–∫–æ—à—Ç–æ–≤–Ω–æ —Å–ø–æ—á–∞—Ç–∫—É**
- –ó–±—ñ—Ä —Ñ—ñ–¥–±–µ–∫—É —Ç–∞ engagement –º–µ—Ç—Ä–∏–∫
- –ú–æ–Ω–µ—Ç–∏–∑—É–≤–∞—Ç–∏ –ø—ñ–∑–Ω—ñ—à–µ

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è:** –í–∞—Ä—ñ–∞–Ω—Ç 3 –¥–ª—è MVP, –ø–æ—Ç—ñ–º –í–∞—Ä—ñ–∞–Ω—Ç 1.

## –ö—Ä–∏—Ç–µ—Ä—ñ—ó –ø—Ä–∏–π–Ω—è—Ç—Ç—è

‚úÖ –§–æ—Ä–º–∞ –≤–≤–æ–¥—É –¥–∞–Ω–∏—Ö –ø–∞—Ä—Ç–Ω–µ—Ä–∞ (—ñ–º'—è, –¥–∞—Ç–∞, —á–∞—Å, –º—ñ—Å—Ü–µ)
‚úÖ –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ Composite Chart (—Å–µ—Ä–µ–¥–Ω—ñ —Ç–æ—á–∫–∏ –ø–ª–∞–Ω–µ—Ç)
‚úÖ –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –≤ Supabase
‚úÖ –í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è –ø–ª–∞–Ω–µ—Ç (—Ç–∞–±–ª–∏—Ü—è –∑ –∑–Ω–∞–∫–∞–º–∏ —Ç–∞ –¥–æ–º–∞–º–∏)
‚úÖ AI –∞–Ω–∞–ª—ñ–∑ –æ—Å–Ω–æ–≤–Ω–∏—Ö –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ (Sun, Moon, Venus, Mars, Mercury)
‚úÖ –î–µ—Ç–∞–ª—å–Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞ –∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º
‚úÖ Share card –¥–ª—è —Å–æ—Ü–º–µ—Ä–µ–∂ (OG image)
‚úÖ Responsive design

## –ú–µ—Ç—Ä–∏–∫–∏ —É—Å–ø—ñ—Ö—É

- –°—Ç–≤–æ—Ä–µ–Ω–Ω—è: > 20% –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ —Å—Ç–≤–æ—Ä—é—é—Ç—å Composite Chart
- Engagement: avg. time –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ > 4 —Ö–≤–∏–ª–∏–Ω–∏
- Share rate: > 15% –¥—ñ–ª—è—Ç—å—Å—è –≤ —Å–æ—Ü–º–µ—Ä–µ–∂–∞—Ö
- Repeat usage: > 30% —Å—Ç–≤–æ—Ä—é—é—Ç—å 2+ Composite Charts (—Ä—ñ–∑–Ω—ñ –ø–∞—Ä—Ç–Ω–µ—Ä–∏)

## –ú–∞–π–±—É—Ç–Ω—ñ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è (post-MVP)

- **Synastry –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è:** Composite Chart + Synastry —Ä–∞–∑–æ–º
- **–ì—Ä–∞—Ñ—ñ—á–Ω–∞ –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è:** –ü–æ–≤–Ω–æ—Ü—ñ–Ω–Ω–µ –∫–æ–ª–µ—Å–æ Composite Chart
- **–¢—Ä–∞–Ω–∑–∏—Ç–∏ –¥–æ Composite:** –Ø–∫ –ø–æ—Ç–æ—á–Ω—ñ –ø–ª–∞–Ω–µ—Ç–∏ –≤–ø–ª–∏–≤–∞—é—Ç—å –Ω–∞ –≤—ñ–¥–Ω–æ—Å–∏–Ω–∏
- **–Ü—Å—Ç–æ—Ä—ñ—è:** –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –≤—Å—ñ—Ö Composite Charts –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
- **–ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è:** "–ü–æ—Ä—ñ–≤–Ω—è—Ç–∏ 2 Composite Charts" (—Ä—ñ–∑–Ω—ñ –ø–∞—Ä—Ç–Ω–µ—Ä–∏)
- **PDF Export:** –ö—Ä–∞—Å–∏–≤–∏–π PDF –∑–≤—ñ—Ç

## Timeline

**–î–µ–Ω—å 1: –ë–µ–∫–µ–Ω–¥ + —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫–∏**
- –ê–ª–≥–æ—Ä–∏—Ç–º midpoint calculation (2 –≥–æ–¥)
- API endpoint (2 –≥–æ–¥)
- –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ Swiss Ephemeris (2 –≥–æ–¥)
- DB —Ç–∞–±–ª–∏—Ü—è —Ç–∞ –º—ñ–≥—Ä–∞—Ü—ñ—è (1 –≥–æ–¥)

**–î–µ–Ω—å 2: UI + —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü—ñ—è**
- –§–æ—Ä–º–∞ –≤–≤–æ–¥—É –ø–∞—Ä—Ç–Ω–µ—Ä–∞ (3 –≥–æ–¥)
- –°—Ç–æ—Ä—ñ–Ω–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É (2 –≥–æ–¥)
- –¢–∞–±–ª–∏—Ü—è –ø–ª–∞–Ω–µ—Ç (2 –≥–æ–¥)

**–î–µ–Ω—å 3: AI –∞–Ω–∞–ª—ñ–∑ + –¥–µ—Ç–∞–ª—ñ**
- AI prompts —Ç–∞ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—è –∞–Ω–∞–ª—ñ–∑—É (3 –≥–æ–¥)
- Share card / OG image (2 –≥–æ–¥)
- –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è —Ç–∞ –±–∞–≥—Ñ—ñ–∫—Å–∏ (3 –≥–æ–¥)

**Total:** 2-3 –¥–Ω—ñ

## –ó–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ

- Natal chart calculation (–≤–∂–µ —î)
- Swiss Ephemeris (–≤–∂–µ —ñ–Ω—Ç–µ–≥—Ä–æ–≤–∞–Ω–æ)
- OpenAI API (–≤–∂–µ —î)
- Supabase (–≤–∂–µ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ)

## –ü–∏—Ç–∞–Ω–Ω—è –¥–ª—è review

1. –ß–∏ —Ä–æ–±–∏—Ç–∏ –≥—Ä–∞—Ñ—ñ—á–Ω—É –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—é –æ–¥—Ä–∞–∑—É, —á–∏ —Å–ø–æ—á–∞—Ç–∫—É MVP –∑ —Ç–∞–±–ª–∏—Ü–µ—é?
2. –ú–æ–Ω–µ—Ç–∏–∑–∞—Ü—ñ—è: –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–æ —Å–ø–æ—á–∞—Ç–∫—É —á–∏ –æ–¥—Ä–∞–∑—É premium?
3. –ß–∏ –¥–æ–¥–∞–≤–∞—Ç–∏ –ø–æ–≤—ñ–ª—å–Ω—ñ –ø–ª–∞–Ω–µ—Ç–∏ (–£—Ä–∞–Ω, –ù–µ–ø—Ç—É–Ω, –ü–ª—É—Ç–æ–Ω) –¥–æ —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É?
4. –ß–∏ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ –≤—Å—ñ Composite Charts –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, —á–∏ —Ç—ñ–ª—å–∫–∏ –æ—Å—Ç–∞–Ω–Ω—ñ–π?
5. –ß–∏ –ø–æ—Ç—Ä—ñ–±–Ω–∞ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –ø–æ—Ä—ñ–≤–Ω—è—Ç–∏ Composite Chart –∑ Synastry?
6. –°–∫—ñ–ª—å–∫–∏ –¥–µ—Ç–∞–ª—ñ–∑–∞—Ü—ñ—ó –≤ AI –∞–Ω–∞–ª—ñ–∑—ñ: –∫–æ—Ä–æ—Ç–∫–æ (500 —Å–ª—ñ–≤) —á–∏ –¥–µ—Ç–∞–ª—å–Ω–æ (1500+)?
