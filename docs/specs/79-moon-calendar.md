# Spec: –ú—ñ—Å—è—á–Ω–∏–π –ö–∞–ª–µ–Ω–¥–∞—Ä (#79)

## –û–≥–ª—è–¥
–ú—ñ—Å—è—á–Ω–∏–π –∫–∞–ª–µ–Ω–¥–∞—Ä –∑ void-of-course –ø–µ—Ä—ñ–æ–¥–∞–º–∏, —Ñ–∞–∑–∞–º–∏ –ú—ñ—Å—è—Ü—è, —Ç–∞ –ø–µ—Ä—Å–æ–Ω–∞–ª—ñ–∑–æ–≤–∞–Ω–∏–º–∏ —â–æ–¥–µ–Ω–Ω–∏–º–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è–º–∏.

## –ë—ñ–∑–Ω–µ—Å-—Ü—ñ–ª—ñ
- **Benchmark:** Susan Miller Moonlight App = $4.99/–º—ñ—Å —Ç—ñ–ª—å–∫–∏ –∑–∞ void periods
- **Strategy:** –ú–∏ –¥–∞—î–º–æ —Ü–µ –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–æ —è–∫ killer retention feature
- **Daily retention:** –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ –ø–µ—Ä–µ–≤—ñ—Ä—è—é—Ç—å —â–æ–¥–Ω—è –ø–µ—Ä–µ–¥ –≤–∞–∂–ª–∏–≤–∏–º–∏ —Ä—ñ—à–µ–Ω–Ω—è–º–∏
- **–ü—Ä–∞–∫—Ç–∏—á–Ω–∞ —Ü—ñ–Ω–Ω—ñ—Å—Ç—å:** "–ö–æ–ª–∏ –ù–ï –ø—ñ–¥–ø–∏—Å—É–≤–∞—Ç–∏ –¥–æ–≥–æ–≤–æ—Ä–∏"
- **Free tier retention tool:** –£—Ç—Ä–∏–º—É—î–º–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –Ω–∞ –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–æ–º—É —Ä—ñ–≤–Ω—ñ

## –©–æ —Ç–∞–∫–µ Void of Course Moon?

**–¢–µ—Ö–Ω—ñ—á–Ω–µ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è:**
- –ü–µ—Ä—ñ–æ–¥ –º—ñ–∂ –æ—Å—Ç–∞–Ω–Ω—ñ–º major –∞—Å–ø–µ–∫—Ç–æ–º –ú—ñ—Å—è—Ü—è (0¬∞, 60¬∞, 90¬∞, 120¬∞, 180¬∞) —Ç–∞ –≤—Ö–æ–¥–æ–º —É –Ω–∞—Å—Ç—É–ø–Ω–∏–π –∑–Ω–∞–∫
- –ú–æ–∂–µ —Ç—Ä–∏–≤–∞—Ç–∏ –≤—ñ–¥ –∫—ñ–ª—å–∫–æ—Ö —Ö–≤–∏–ª–∏–Ω –¥–æ ~2.5 –¥–Ω—ñ–≤ (—Ä—ñ–¥–∫–æ)
- –ó–∞–∑–≤–∏—á–∞–π 10-30 —Ö–≤–∏–ª–∏–Ω

**–ê—Å—Ç—Ä–æ–ª–æ–≥—ñ—á–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è:**
- "–ü–æ—Ä–æ–∂–Ω—ñ–π —Ö—ñ–¥" ‚Äî –¥—ñ—ó –º–æ–∂—É—Ç—å –±—É—Ç–∏ –º–∞—Ä–Ω–∏–º–∏
- –†—ñ—à–µ–Ω–Ω—è –ø—Ä–∏–π–Ω—è—Ç—ñ –≤ —Ü–µ–π –ø–µ—Ä—ñ–æ–¥ –º–æ–∂—É—Ç—å –Ω–µ —Å–ø—Ä–∞—Ü—é–≤–∞—Ç–∏ —è–∫ –æ—á—ñ–∫—É–≤–∞–ª–æ—Å—å
- –ù–ï —á–∞—Å –¥–ª—è: –ø—ñ–¥–ø–∏—Å–∞–Ω–Ω—è –¥–æ–≥–æ–≤–æ—Ä—ñ–≤, –ø–æ—á–∞—Ç–∫—É –ø—Ä–æ–µ–∫—Ç—ñ–≤, –≤–µ–ª–∏–∫–∏—Ö –ø–æ–∫—É–ø–æ–∫, —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–π
- OK –¥–ª—è: —Ä—É—Ç–∏–Ω–Ω–∏—Ö —Å–ø—Ä–∞–≤, –≤—ñ–¥–ø–æ—á–∏–Ω–∫—É, —Ç–≤–æ—Ä—á–æ—Å—Ç—ñ, –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è —Å—Ç–∞—Ä–∏—Ö —Å–ø—Ä–∞–≤

## –§–∞–∑–∏ –ú—ñ—Å—è—Ü—è

### 4 –æ—Å–Ω–æ–≤–Ω—ñ —Ñ–∞–∑–∏:
1. **New Moon (–ù–æ–≤–æ–º—ñ—Å—è—á—á—è)** ‚Äî 0¬∞
   - –ü–æ—á–∞—Ç–∫–∏, –Ω–æ–≤—ñ –ø—Ä–æ–µ–∫—Ç–∏
   - –ü–æ—Å—ñ–≤ –∑–µ—Ä–Ω–∞
   
2. **First Quarter (–ü–µ—Ä—à–∞ —á–≤–µ—Ä—Ç—å)** ‚Äî 90¬∞
   - –î—ñ—è, –ø–æ–¥–æ–ª–∞–Ω–Ω—è –≤–∏–∫–ª–∏–∫—ñ–≤
   - –†—ñ—Å—Ç, —Ä–æ–∑–≤–∏—Ç–æ–∫
   
3. **Full Moon (–ü–æ–≤–Ω–∏–π –º—ñ—Å—è—Ü—å)** ‚Äî 180¬∞
   - –ö—É–ª—å–º—ñ–Ω–∞—Ü—ñ—è, —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è
   - –ï–º–æ—Ü—ñ—ó –Ω–∞ –ø—ñ–∫—É
   - –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—è —Ü–∏–∫–ª—ñ–≤
   
4. **Last Quarter (–û—Å—Ç–∞–Ω–Ω—è —á–≤–µ—Ä—Ç—å)** ‚Äî 270¬∞
   - –†–µ—Ñ–ª–µ–∫—Å—ñ—è, –≤—ñ–¥–ø—É—Å–∫–∞–Ω–Ω—è
   - –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–æ –Ω–æ–≤–æ–≥–æ —Ü–∏–∫–ª—É

### 8 —Ñ–∞–∑ (–æ–ø—Ü—ñ–π–Ω–æ –¥–ª—è v2):
- New Moon
- Waxing Crescent
- First Quarter
- Waxing Gibbous
- Full Moon
- Waning Gibbous
- Last Quarter
- Waning Crescent

## –§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ –≤–∏–º–æ–≥–∏

### 1. Void of Course –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
```
–î–ª—è –∫–æ–∂–Ω–æ–≥–æ –¥–Ω—è:
1. –û—Ç—Ä–∏–º–∞—Ç–∏ –ø–æ–∑–∏—Ü—ñ—é –ú—ñ—Å—è—Ü—è (ephemeris)
2. –ó–Ω–∞–π—Ç–∏ –≤—Å—ñ –º–∞–π–±—É—Ç–Ω—ñ –∞—Å–ø–µ–∫—Ç–∏ –¥–æ –ø–ª–∞–Ω–µ—Ç (0¬∞, 60¬∞, 90¬∞, 120¬∞, 180¬∞)
3. –í–∏–∑–Ω–∞—á–∏—Ç–∏ –û–°–¢–ê–ù–ù–Ü–ô major –∞—Å–ø–µ–∫—Ç –ø–µ—Ä–µ–¥ –∑–º—ñ–Ω–æ—é –∑–Ω–∞–∫—É
4. –ü–µ—Ä—ñ–æ–¥ –º—ñ–∂ –æ—Å—Ç–∞–Ω–Ω—ñ–º –∞—Å–ø–µ–∫—Ç–æ–º —Ç–∞ ingress = VoC
```

**–î–∞–Ω—ñ:**
- Swiss Ephemeris –¥–ª—è —Ç–æ—á–Ω–∏—Ö —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—ñ–≤
- –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –Ω–∞ 30 –¥–Ω—ñ–≤ –≤–ø–µ—Ä–µ–¥ (–æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è)
- Cache –≤ –±–∞–∑—ñ (regenerate —â–æ—Ç–∏–∂–Ω—è)

**–í–∏—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ:**
```json
{
  "date": "2026-02-24",
  "voidPeriods": [
    {
      "start": "2026-02-24T14:23:00Z",
      "end": "2026-02-24T18:45:00Z",
      "moonSign": "Aries",
      "nextSign": "Taurus",
      "lastAspect": "Square Mars"
    }
  ]
}
```

### 2. –§–∞–∑–∏ –ú—ñ—Å—è—Ü—è

**–†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫:**
- –ö—É—Ç –º—ñ–∂ –°–æ–Ω—Ü–µ–º —Ç–∞ –ú—ñ—Å—è—Ü–µ–º
- 0¬∞ = New Moon
- 90¬∞ = First Quarter
- 180¬∞ = Full Moon
- 270¬∞ = Last Quarter

**–í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è:**
- SVG/Canvas —ñ–∫–æ–Ω–∫–∞ –ø–æ—Ç–æ—á–Ω–æ—ó —Ñ–∞–∑–∏
- –í—ñ–¥—Å–æ—Ç–æ–∫ –æ—Å–≤—ñ—Ç–ª–µ–Ω–æ—Å—Ç—ñ (0-100%)
- –ù–∞–∑–≤–∞ —Ñ–∞–∑–∏ —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—é

### 3. –ú—ñ—Å—è—á–Ω—ñ –¢—Ä–∞–Ω–∑–∏—Ç–∏ (–ø–µ—Ä—Å–æ–Ω–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ)

**–©–æ –ø–æ–∫–∞–∑—É–≤–∞—Ç–∏:**
- "–ú—ñ—Å—è—Ü—å —É [–ó–Ω–∞–∫]" ‚Äî –∑–∞–≥–∞–ª—å–Ω–∞ –µ–Ω–µ—Ä–≥—ñ—è
- "–ú—ñ—Å—è—Ü—å —É –≤–∞—à–æ–º—É [X –¥–æ–º—ñ]" ‚Äî –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∏–π –≤–ø–ª–∏–≤
- –ö–æ—Ä–æ—Ç–∫–∏–π –æ–ø–∏—Å (2-3 —Ä–µ—á–µ–Ω–Ω—è)

**–ü—Ä–∏–∫–ª–∞–¥:**
```
–ú—ñ—Å—è—Ü—å —É –†–∞–∫—É
–ß–∞—Å –¥–ª—è —Ä–æ–¥–∏–Ω–∏, –¥–æ–º–∞—à–Ω—å–æ–≥–æ –∑–∞—Ç–∏—à–∫—É, –µ–º–æ—Ü—ñ–π–Ω–∏—Ö –∑–≤'—è–∑–∫—ñ–≤.

–ú—ñ—Å—è—Ü—å —É –≤–∞—à–æ–º—É 4 –¥–æ–º—ñ
–§–æ–∫—É—Å –Ω–∞ –¥—ñ–º —Ç–∞ —Å—ñ–º–µ–π–Ω—ñ —Å–ø—Ä–∞–≤–∏. –í—ñ–¥–º—ñ–Ω–Ω–∏–π —á–∞—Å –¥–ª—è —Ä–µ–º–æ–Ω—Ç—É —á–∏ –∑–º—ñ–Ω–∏ —ñ–Ω—Ç–µ—Ä'—î—Ä—É.
```

### 4. –©–æ–¥–µ–Ω–Ω—ñ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó

**–ù–∞ –æ—Å–Ω–æ–≤—ñ:**
- Void of Course –ø–µ—Ä—ñ–æ–¥—ñ–≤
- –§–∞–∑–∏ –ú—ñ—Å—è—Ü—è
- –ú—ñ—Å—è—á–Ω–∏—Ö —Ç—Ä–∞–Ω–∑–∏—Ç—ñ–≤ –¥–æ –Ω–∞—Ç–∞–ª—å–Ω–æ–≥–æ —á–∞—Ä—Ç—É

**–ü—Ä–∏–∫–ª–∞–¥:**
```
‚úÖ –î–æ–±—Ä–µ –¥–ª—è:
- –†—É—Ç–∏–Ω–Ω–∏—Ö —Å–ø—Ä–∞–≤
- –¢–≤–æ—Ä—á–æ—Å—Ç—ñ
- –í—ñ–¥–ø–æ—á–∏–Ω–∫—É

‚ùå –£–Ω–∏–∫–∞—Ç–∏:
- –ü—ñ–¥–ø–∏—Å–∞–Ω–Ω—è –¥–æ–≥–æ–≤–æ—Ä—ñ–≤ (VoC –¥–æ 18:45)
- –í–∞–∂–ª–∏–≤–∏—Ö —Ä—ñ—à–µ–Ω—å
- –í–µ–ª–∏–∫–∏—Ö –ø–æ–∫—É–ø–æ–∫
```

## UI/UX Design

### Dashboard Widget
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ üåô –ú—ñ—Å—è—Ü—å –°—å–æ–≥–æ–¥–Ω—ñ              ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ [üåó] Waning Gibbous (68%)       ‚îÇ
‚îÇ                                 ‚îÇ
‚îÇ ‚ö†Ô∏è Void of Course               ‚îÇ
‚îÇ 14:23 - 18:45 (4–≥ 22—Ö–≤)         ‚îÇ
‚îÇ                                 ‚îÇ
‚îÇ –ú—ñ—Å—è—Ü—å —É –û–≤–Ω—ñ ‚Üí –≤–∞—à 3 –¥—ñ–º       ‚îÇ
‚îÇ –ß–∞—Å –¥–ª—è –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—ó —Ç–∞ –Ω–∞–≤—á–∞–Ω–Ω—è ‚îÇ
‚îÇ                                 ‚îÇ
‚îÇ [–î–µ—Ç–∞–ª—å–Ω—ñ—à–µ ‚Üí]                  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ö–∞–ª–µ–Ω–¥–∞—Ä View

**Monthly Calendar:**
- –ö–æ–∂–µ–Ω –¥–µ–Ω—å: —ñ–∫–æ–Ω–∫–∞ —Ñ–∞–∑–∏ –ú—ñ—Å—è—Ü—è
- –ß–µ—Ä–≤–æ–Ω—ñ –ø–µ—Ä—ñ–æ–¥–∏ VoC
- Hover: –¥–µ—Ç–∞–ª—å–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è
- Click: —Ä–æ–∑–≥–æ—Ä–Ω—É—Ç–∏–π –¥–µ–Ω—å

**Day Detail:**
```
–ü–æ–Ω–µ–¥—ñ–ª–æ–∫, 24 –õ—é—Ç–æ–≥–æ 2026

üåó Waning Gibbous (68%)

‚ö†Ô∏è Void of Course
14:23 - 18:45 UTC

–ú—ñ—Å—è—Ü—å: –û–≤–µ–Ω ‚Üí –¢–µ–ª–µ—Ü—å (18:45)
–£ –≤–∞—à–æ–º—É —á–∞—Ä—Ç—ñ: 3 –¥—ñ–º ‚Üí 4 –¥—ñ–º

–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó:
‚úÖ –î–æ–±—Ä–µ: —Ä—É—Ç–∏–Ω–Ω—ñ —Å–ø—Ä–∞–≤–∏, –≤—ñ–¥–ø–æ—á–∏–Ω–æ–∫
‚ùå –£–Ω–∏–∫–∞—Ç–∏: –≤–∞–∂–ª–∏–≤–∏—Ö —Ä—ñ—à–µ–Ω—å –¥–æ 18:45

–î–µ—Ç–∞–ª—å–Ω—ñ—à–µ: [—Ä–æ–∑–≥–æ—Ä–Ω—É—Ç–∏]
```

### Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–Ω—è (–æ–ø—Ü—ñ–π–Ω–æ –¥–ª—è v1)

**–¢–∏–ø–∏:**
1. –†–∞–Ω–∫–æ–≤–µ: "–î–æ–±—Ä–æ–≥–æ —Ä–∞–Ω–∫—É! –ú—ñ—Å—è—Ü—å —É [–ó–Ω–∞–∫], void period –æ [—á–∞—Å]"
2. –ü–æ–ø–µ—Ä–µ–¥–∂–µ–Ω–Ω—è VoC: "–ó–∞ 30 —Ö–≤ VoC –ø–µ—Ä—ñ–æ–¥. –ó–∞–≤–µ—Ä—à—ñ—Ç—å –≤–∞–∂–ª–∏–≤—ñ —Å–ø—Ä–∞–≤–∏"
3. New/Full Moon: "–°—å–æ–≥–æ–¥–Ω—ñ [–ü–æ–≤–Ω–∏–π –º—ñ—Å—è—Ü—å] —É [–ó–Ω–∞–∫]!"

## –¢–µ—Ö–Ω—ñ—á–Ω–∞ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è

### Stack
- **Frontend:** Next.js + React
- **Ephemeris:** Swiss Ephemeris (npm package `sweph` –∞–±–æ API)
- **Storage:** Supabase
- **Caching:** –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –Ω–∞ 30 –¥–Ω—ñ–≤ –≤–ø–µ—Ä–µ–¥, regenerate —â–æ—Ç–∏–∂–Ω—è

### Database Schema

```sql
-- –ú—ñ—Å—è—á–Ω—ñ –¥–∞–Ω—ñ (pre-calculated)
CREATE TABLE moon_calendar (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  date DATE NOT NULL UNIQUE,
  moon_sign TEXT NOT NULL,
  moon_phase TEXT NOT NULL, -- 'new', 'waxing_crescent', 'first_quarter', etc
  moon_phase_angle DECIMAL(5,2) NOT NULL, -- 0-360
  illumination_percent DECIMAL(5,2) NOT NULL, -- 0-100
  void_of_course JSONB, -- {start, end, lastAspect, nextSign}
  created_at TIMESTAMP DEFAULT NOW()
);

CREATE INDEX idx_moon_calendar_date ON moon_calendar(date);

-- –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ñ –º—ñ—Å—è—á–Ω—ñ —Ç—Ä–∞–Ω–∑–∏—Ç–∏ (cached per user)
CREATE TABLE moon_transits_cache (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  user_id UUID REFERENCES auth.users(id),
  date DATE NOT NULL,
  moon_house INTEGER NOT NULL, -- 1-12
  interpretation TEXT,
  recommendations TEXT,
  created_at TIMESTAMP DEFAULT NOW(),
  UNIQUE(user_id, date)
);

CREATE INDEX idx_moon_transits_user_date ON moon_transits_cache(user_id, date);
```

### API Endpoints

**GET /api/moon/calendar**
```
Query params:
  ?from=2026-02-23&to=2026-03-23
  
Response:
{
  "days": [
    {
      "date": "2026-02-24",
      "moonSign": "Aries",
      "phase": "waning_gibbous",
      "phaseAngle": 245.3,
      "illumination": 68.2,
      "voidOfCourse": {
        "start": "2026-02-24T14:23:00Z",
        "end": "2026-02-24T18:45:00Z",
        "lastAspect": "Square Mars",
        "nextSign": "Taurus"
      }
    }
  ]
}
```

**GET /api/moon/today**
```
Query params:
  ?userId=<uuid> (–¥–ª—è –ø–µ—Ä—Å–æ–Ω–∞–ª—ñ–∑–∞—Ü—ñ—ó)
  
Response:
{
  "date": "2026-02-24",
  "moonSign": "Aries",
  "phase": "waning_gibbous",
  "phaseAngle": 245.3,
  "illumination": 68.2,
  "voidOfCourse": {...},
  "personalTransit": {
    "house": 3,
    "interpretation": "–ú—ñ—Å—è—Ü—å —É –≤–∞—à–æ–º—É 3 –¥–æ–º—ñ...",
    "recommendations": {
      "good": ["–ö–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—è", "–ù–∞–≤—á–∞–Ω–Ω—è", "–ö–æ—Ä–æ—Ç–∫—ñ –ø–æ—ó–∑–¥–∫–∏"],
      "avoid": ["–í–∞–∂–ª–∏–≤—ñ —Ä—ñ—à–µ–Ω–Ω—è –¥–æ 18:45"]
    }
  }
}
```

### –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ VoC (Pseudocode)

```javascript
function calculateVoidOfCourse(date) {
  const moon = getMoonPosition(date)
  const planets = getAllPlanetPositions(date)
  const moonIngress = getNextMoonSignChange(date)
  
  // –ó–Ω–∞–π—Ç–∏ –≤—Å—ñ –∞—Å–ø–µ–∫—Ç–∏ –≤—ñ–¥ –ø–æ—Ç–æ—á–Ω–æ–≥–æ –º–æ–º–µ–Ω—Ç—É –¥–æ ingress
  const aspects = []
  for (const planet of planets) {
    const aspect = calculateAspect(moon, planet)
    if (isMajorAspect(aspect) && aspect.exactTime < moonIngress) {
      aspects.push(aspect)
    }
  }
  
  // –û—Å—Ç–∞–Ω–Ω—ñ–π –∞—Å–ø–µ–∫—Ç = –ø–æ—á–∞—Ç–æ–∫ VoC
  const lastAspect = aspects.sort((a, b) => b.exactTime - a.exactTime)[0]
  
  if (!lastAspect) return null
  
  return {
    start: lastAspect.exactTime,
    end: moonIngress,
    lastAspect: lastAspect.name,
    nextSign: moonIngress.sign
  }
}
```

### –ö–µ—à—É–≤–∞–Ω–Ω—è —Ç–∞ –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è

**–°—Ç—Ä–∞—Ç–µ–≥—ñ—è:**
1. Pre-calculate 30 –¥–Ω—ñ–≤ –≤–ø–µ—Ä–µ–¥ –∫–æ–∂–Ω–æ–≥–æ —Ç–∏–∂–Ω—è (cron)
2. Store –≤ `moon_calendar` table
3. Frontend —á–∏—Ç–∞—î –∑ cache
4. User-specific transit —Ä–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ on-demand (–∞–±–æ lazy cache)

**Cron Job:**
```javascript
// –©–æ—Ç–∏–∂–Ω—è –æ 00:00 –Ω–µ–¥—ñ–ª—ñ
async function regenerateMoonCalendar() {
  const startDate = new Date()
  const endDate = addDays(startDate, 30)
  
  for (let date = startDate; date <= endDate; date = addDays(date, 1)) {
    const moonData = calculateMoonData(date)
    await supabase.from('moon_calendar').upsert({
      date: date.toISOString().split('T')[0],
      ...moonData
    })
  }
}
```

## MVP (v1) Timeline: 2-3 –¥–Ω—ñ

### –î–µ–Ω—å 1: Backend + –†–æ–∑—Ä–∞—Ö—É–Ω–∫–∏
- ‚úÖ Swiss Ephemeris —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è
- ‚úÖ VoC —Ä–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –∞–ª–≥–æ—Ä–∏—Ç–º
- ‚úÖ Moon phase —Ä–æ–∑—Ä–∞—Ö—É–Ω–æ–∫
- ‚úÖ Database schema + seed data (30 –¥–Ω—ñ–≤)
- ‚úÖ API endpoints

### –î–µ–Ω—å 2: UI/UX
- ‚úÖ Dashboard widget
- ‚úÖ Calendar view (monthly)
- ‚úÖ Day detail page
- ‚úÖ Moon phase SVG icons
- ‚úÖ VoC warning indicators

### –î–µ–Ω—å 3: –ü–µ—Ä—Å–æ–Ω–∞–ª—ñ–∑–∞—Ü—ñ—è + Polish
- ‚úÖ User-specific house transit —Ä–æ–∑—Ä–∞—Ö—É–Ω–æ–∫
- ‚úÖ Recommendations engine
- ‚úÖ AI-generated daily interpretations (–æ–ø—Ü—ñ–π–Ω–æ)
- ‚úÖ Testing + bug fixes
- ‚úÖ Mobile responsive

## v2 Features (Future)

**Push Notifications:**
- Morning: "–î–æ–±—Ä–æ–≥–æ —Ä–∞–Ω–∫—É! VoC –æ 14:23"
- VoC Warning: "–ó–∞ 30 —Ö–≤ VoC –ø–µ—Ä—ñ–æ–¥"
- Full Moon alerts

**8 —Ñ–∞–∑ –∑–∞–º—ñ—Å—Ç—å 4:**
- Waxing Crescent, Waning Gibbous, etc

**Historical tracking:**
- "–ü–æ–¥–∏–≤—ñ—Ç—å—Å—è —â–æ –±—É–ª–æ –ø—ñ–¥ —á–∞—Å –º–∏–Ω—É–ª–æ–≥–æ Full Moon"

**Email digest:**
- –¢–∏–∂–Ω–µ–≤–∏–π –æ–≥–ª—è–¥ –º—ñ—Å—è—á–Ω–∏—Ö –ø–æ–¥—ñ–π

**Advanced recommendations:**
- AI –∞–Ω–∞–ª—ñ–∑ –≤–∞—à–∏—Ö —Ç—Ä–∞–Ω–∑–∏—Ç—ñ–≤ + –º—ñ—Å—è—á–Ω–∏—Ö —Ü–∏–∫–ª—ñ–≤

## –ú–µ—Ç—Ä–∏–∫–∏ —É—Å–ø—ñ—Ö—É

**Launch (–ø–µ—Ä—à–∏–π –º—ñ—Å—è—Ü—å):**
- Daily active users > 50% from total users
- Page views per user > 3/–¥–µ–Ω—å
- Time on page > 2 —Ö–≤

**Retention:**
- D7 retention > 40%
- D30 retention > 20%
- Weekly return rate > 60%

**Engagement:**
- "–î–æ–¥–∞–≤ –≤ –∑–∞–∫–ª–∞–¥–∫–∏" > 30%
- Shares "VoC saved me!" testimonials > 10
- User feedback: "–ö–æ—Ä–∏—Å–Ω–∞ —Ñ—ñ—á–∞" > 80%

## –ö–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–∏–π –∞–Ω–∞–ª—ñ–∑

| –ü—Ä–æ–¥—É–∫—Ç | VoC | Phases | –ü–µ—Ä—Å–æ–Ω–∞–ª—ñ–∑–∞—Ü—ñ—è | –¶—ñ–Ω–∞ |
|---------|-----|--------|----------------|------|
| Susan Miller Moonlight | ‚úÖ | ‚úÖ | ‚ùå | $4.99/–º—ñ—Å |
| Co-Star | ‚ùå | ‚úÖ (basic) | ‚úÖ | Free |
| Astro.com | ‚úÖ (extended) | ‚úÖ | ‚úÖ | Free + Premium |
| **AstroSvitla** | ‚úÖ | ‚úÖ | ‚úÖ | **Free** |

**–ù–∞—à–∞ –ø–µ—Ä–µ–≤–∞–≥–∞:** –í—Å–µ –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–æ + –ø–µ—Ä—Å–æ–Ω–∞–ª—ñ–∑–∞—Ü—ñ—è

## Refs & Resources

**Ephemeris:**
- Swiss Ephemeris: https://www.astro.com/swisseph/
- NPM: `sweph` –∞–±–æ `ephemeris`

**VoC —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫–∏:**
- CafeAstrology VoC calculator
- Susan Miller Moonlight App

**Moon phases:**
- NASA Moon Phase data
- Astro.com Moon calendar

**UI inspiration:**
- Susan Miller Moonlight App (clean, functional)
- Co-Star (minimal, beautiful)

## Legal & Disclaimers

**Disclaimer:**
> "–ê—Å—Ç—Ä–æ–ª–æ–≥—ñ—á–Ω—ñ –ø–æ—Ä–∞–¥–∏ –Ω–∞–¥–∞—é—Ç—å—Å—è –¥–ª—è —Ä–æ–∑–≤–∞–≥–∏ —Ç–∞ —Å–∞–º–æ—Ä–æ–∑–≤–∏—Ç–∫—É. –ù–µ –∑–∞–º—ñ–Ω—é—é—Ç—å –ø—Ä–æ—Ñ–µ—Å—ñ–π–Ω—É —é—Ä–∏–¥–∏—á–Ω—É, –º–µ–¥–∏—á–Ω—É —á–∏ —Ñ—ñ–Ω–∞–Ω—Å–æ–≤—É –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü—ñ—é."

---
**Created:** 2026-02-23
**Status:** Pending Approval
**Estimate:** 2-3 days
**Priority:** P0 (Must Have)
**Impact:** Daily retention tool, practical value
